<Activity mc:Ignorable="sap sap2010" x:Class="_02_read_pdf_new" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:s="clr-namespace:System;assembly=System.Private.CoreLib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Private.CoreLib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=System.Private.CoreLib" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:uibi="http://schemas.uipath.com/workflow/infrastructure/baf/uibi" xmlns:uiisi="http://schemas.uipath.com/workflow/infrastructure/is/uiisi" xmlns:uisape="clr-namespace:UiPath.IntelligentOCR.StudioWeb.Activities.PDF.ExtractPDFText;assembly=UiPath.IntelligentOCR.StudioWeb.Activities" xmlns:uoia="clr-namespace:UiPath.OpenAI.IntegrationService.Activities;assembly=UiPath.OpenAI.IntegrationService.Activities" xmlns:uoic="clr-namespace:UiPath.OpenAI.IntegrationService.Client;assembly=UiPath.OpenAI.IntegrationService" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_pdf_file" Type="InArgument(x:String)" />
    <x:Property Name="out_response_text" Type="OutArgument(x:String)" />
  </x:Members>
  <VisualBasic.Settings>
    <x:Null />
  </VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>829.3333333333334,2572</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>_02_read_pdf_new_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>GlobalVariablesNamespace</x:String>
      <x:String>GlobalConstantsNamespace</x:String>
      <x:String>UiPath.OpenAI.IntegrationService.Client</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>UiPath.BAF.Infrastructure.Entity</x:String>
      <x:String>UiPath.IntegrationService.Infrastructure.Descriptor</x:String>
      <x:String>UiPath.BAF.Infrastructure.Enums</x:String>
      <x:String>UiPath.BAF.Infrastructure.Telemetry</x:String>
      <x:String>UiPath.BAF.Infrastructure</x:String>
      <x:String>UiPath.BAF.Infrastructure.Connection</x:String>
      <x:String>UiPath.IntelligentOCR.StudioWeb.Activities.PDF.ExtractPDFText</x:String>
      <x:String>UiPath.IntelligentOCR.StudioWeb.Activities.PDF</x:String>
      <x:String>UiPath.OpenAI.IntegrationService.Activities</x:String>
      <x:String>UiPath.IntegrationCore.Activities</x:String>
      <x:String>UiPath.BAF.Activities</x:String>
      <x:String>UiPath.BAF.Infrastructure.Contracts</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.Collections</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Drawing.Common</AssemblyReference>
      <AssemblyReference>System.Drawing.Primitives</AssemblyReference>
      <AssemblyReference>System.Linq</AssemblyReference>
      <AssemblyReference>System.Net.Mail</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Private.CoreLib</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>UiPath.OpenAI.IntegrationService</AssemblyReference>
      <AssemblyReference>System.Reflection.DispatchProxy</AssemblyReference>
      <AssemblyReference>System.Reflection.TypeExtensions</AssemblyReference>
      <AssemblyReference>System.Reflection.Metadata</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>System.Private.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Formatters</AssemblyReference>
      <AssemblyReference>System.Private.DataContractSerialization</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Primitives</AssemblyReference>
      <AssemblyReference>UiPath.BAF.Infrastructure</AssemblyReference>
      <AssemblyReference>UiPath.IntegrationService.Infrastructure</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR.StudioWeb.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OpenAI.IntegrationService.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.ViewModels</AssemblyReference>
      <AssemblyReference>UiPath.Workflow</AssemblyReference>
      <AssemblyReference>NPOI</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities.Design</AssemblyReference>
      <AssemblyReference>System.Memory.Data</AssemblyReference>
      <AssemblyReference>System.Console</AssemblyReference>
      <AssemblyReference>System.Configuration.ConfigurationManager</AssemblyReference>
      <AssemblyReference>System.Security.Permissions</AssemblyReference>
      <AssemblyReference>System.ComponentModel</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Private.Uri</AssemblyReference>
      <AssemblyReference>System.IO.FileSystem.Watcher</AssemblyReference>
      <AssemblyReference>System.IO.Packaging</AssemblyReference>
      <AssemblyReference>System.IO.FileSystem.AccessControl</AssemblyReference>
      <AssemblyReference>System.IO.FileSystem.DriveInfo</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldCollapseAll">False</x:Boolean>
      <x:Boolean x:Key="ShouldExpandAll">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Sequence sap2010:Annotation.AnnotationText="Extract data from the pdfs (invoices) with generative AI (ChatGPT)." DisplayName="_02_read_pdf_new" sap:VirtualizedContainerService.HintSize="496,2507.3333333333335" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="uoic:GenerateChatCompletion" Name="response" />
      <Variable x:TypeArguments="x:String" Name="pdf_text" />
      <Variable x:TypeArguments="x:String" Name="date_today" />
      <Variable x:TypeArguments="x:String" Name="file_path" />
      <Variable x:TypeArguments="s:String[]" Name="pdf_file_list" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,144.66666666666666" sap2010:WorkflowViewState.IdRef="LogMessage_3" Level="Info" Message="[&quot;----- Starting Sequence 02 -----&quot;]" />
    <Assign sap2010:Annotation.AnnotationText="Get value of in_argument: path to the pdf file." sap:VirtualizedContainerService.HintSize="434,116" sap2010:WorkflowViewState.IdRef="Assign_6">
      <Assign.To>
        <OutArgument x:TypeArguments="x:String">[file_path]</OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="x:String">[in_pdf_file]</InArgument>
      </Assign.Value>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </Assign>
    <If sap2010:Annotation.AnnotationText="Check if the file exists." Condition="[Not File.Exists(file_path)]" sap:VirtualizedContainerService.HintSize="434,654.6666666666666" sap2010:WorkflowViewState.IdRef="If_2">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <If.Then>
        <Sequence sap:VirtualizedContainerService.HintSize="376,440" sap2010:WorkflowViewState.IdRef="Sequence_6">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:LogMessage sap2010:Annotation.AnnotationText="Log Message explaining that the file doesn't exist." DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,175.33333333333334" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="[UiPath.Core.Activities.LogLevel.Fatal]" Message="[&quot;File doesn't exist. Incoming Argument must be wrong.&quot;]">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:LogMessage>
          <Throw sap2010:Annotation.AnnotationText="As something must have gone wrong in the code earlier, we throw an error." Exception="[New Exception(&quot;File doesn't exist!&quot;)]" sap:VirtualizedContainerService.HintSize="334,137.33333333333334" sap2010:WorkflowViewState.IdRef="Throw_4">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Throw>
        </Sequence>
      </If.Then>
      <If.Else>
        <Sequence sap:VirtualizedContainerService.HintSize="300,81.33333333333333" sap2010:WorkflowViewState.IdRef="Sequence_7">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </Sequence>
      </If.Else>
    </If>
    <uisape:ExtractPDFText ApplyOcr="{x:Null}" FilePassword="{x:Null}" OcrEngine="{x:Null}" sap2010:Annotation.AnnotationText="Extract text from PDF and assign to variable pdf_text" DisplayName="Extract PDF Text" sap:VirtualizedContainerService.HintSize="434,122.66666666666667" sap2010:WorkflowViewState.IdRef="ExtractPDFText_2" PdfFile="[LocalResource.FromPath(file_path)]" Text="[pdf_text]">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </uisape:ExtractPDFText>
    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,144.66666666666666" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Info" Message="[&quot;Extracted text from pdf.&quot;]" />
    <ui:MessageBox Caption="{x:Null}" ChosenButton="{x:Null}" AutoCloseAfter="00:00:00" DisplayName="Message Box" sap:VirtualizedContainerService.HintSize="434,86.66666666666667" sap2010:WorkflowViewState.IdRef="MessageBox_4" Text="[&quot;PDF Text:&#xA;-----------&#xA;&quot;+pdf_text]" />
    <Assign sap2010:Annotation.AnnotationText="Variable with today's date" sap:VirtualizedContainerService.HintSize="434,116" sap2010:WorkflowViewState.IdRef="Assign_3">
      <Assign.To>
        <OutArgument x:TypeArguments="x:String">[date_today]</OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("yyyy-MM-ddTHH:mm:ssZ")]</InArgument>
      </Assign.Value>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </Assign>
    <uoia:GenerateChatCompletion ActivityInstanceId="15c482c0-6a74-4fe2-8e09-9a24a38ffc61" sap2010:Annotation.AnnotationText="ChatGPT - Extract and structure invocie data as a string in the format of a JSON.&#xA;Input: pdf_text&#xA;Output: response" BindingsVersion="2.1" BusinessEntityName="Chatvervollständigung generieren" ConfiguredBusinessEntity="generateChatCompletion" ConnectionId="8a004e94-db95-449c-a9f8-a9953dc626b7" Connector="uipath-openai-openai" CrudOperation="Create" DesignConnectionEnabled="True" DisplayName="Generate Chat Completion" sap:VirtualizedContainerService.HintSize="434,233.33333333333334" sap2010:WorkflowViewState.IdRef="GenerateChatCompletion_1" Language="de">
      <uoia:GenerateChatCompletion.BusinessEntity>
        <uibi:BusinessEntity Metadata="{x:Reference __ReferenceID14}" Name="generateChatCompletion">
          <uibi:BusinessEntity.AllFields>
            <scg:List x:TypeArguments="uibi:EntityField" Capacity="15">
              <uiisi:OperationEntityField x:TypeArguments="uoic:GenerateChatCompletion" ArgumentDirection="In" ArgumentType="uoic:GenerateChatCompletion" DataType="GenerateChatCompletion" Description="The request data in JSON format for the chat completion" DisplayName="Completion Request" FormDataType="ExpressionTextBox" IsChildEntityField="False" IsCustomField="False" IsDefault="False" IsDeletable="True" IsHidden="True" IsIdField="False" IsMandatory="True" IsParameter="True" IsPriority="False" IsSelected="False" Location="Undefined" Name="body" ShouldFilterOnChange="False" />
              <uiisi:OperationEntityField x:TypeArguments="uoic:GenerateChatCompletion" x:Name="__ReferenceID28" ArgumentDirection="Out" ArgumentType="uoic:GenerateChatCompletion" DataType="GenerateChatCompletion" Description="Das zurückgegebene Chatvervollständigung generieren-Objekt." DisplayName="Antwort" FormDataType="ExpressionTextBox" IsChildEntityField="False" IsCustomField="False" IsDefault="False" IsDeletable="True" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="Response" OutArgumentValue="[response]" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <OutArgument x:TypeArguments="uoic:GenerateChatCompletion">[response]</OutArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsPermanentlyHidden">False</x:Boolean>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
                <uiisi:OperationEntityField.Value>
                  <VisualBasicReference x:TypeArguments="uoic:GenerateChatCompletion">[response]</VisualBasicReference>
                </uiisi:OperationEntityField.Value>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="x:String" x:Name="__ReferenceID15" ArgumentDirection="In" ArgumentType="x:String" DataType="String" DefaultValue="Write an email to a new sales lead" Description="The prompt to use for the chat completion(s) generation" DisplayName="Aufforderung" FormDataType="ExpressionTextBox" InArgumentValue="[pdf_text]" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="True" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.prompt" Order="1" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="x:String">[pdf_text]</InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
                <uiisi:OperationEntityField.Value>
                  <VisualBasicValue x:TypeArguments="x:String">[pdf_text]</VisualBasicValue>
                </uiisi:OperationEntityField.Value>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="x:String" x:Name="__ReferenceID16" ArgumentDirection="In" ArgumentType="x:String" DataType="String" Description="Anweisungen leiten die KI an, entsprechend Ihrer Absicht zu reagieren. Der Standardwert ist NULL." DisplayName="Anweisung" FormDataType="ExpressionTextBox" InArgumentValue="[&quot;I will give you a German text from an invoice.&#xA;Please extract the relevant information and prepare a JSON.&#xA;For the first and lasst name use the name that you think is the invoice recipient.&#xA;Also for the address use the address of the recipient (in German this is sometimes called Rechnungsadresse).&#xA;If the invoice recipient is not a person, but a company, write its company name at firstName and write no last name&#xA;Preferably, for the InvoiceNr use the Rechnungsnummer, not the Bestellnummer.&#xA;For currencies, use the ISO currency code (like EUR or CHF).&#xA;For company, use the name of the company that is issuing the invoice.&#xA;For createDate and modifiedDate, use&quot; + date_today + &quot;.&#xA;For invoiceForwarded, write false.&#xA;Please only give me the JSON In the response, Nothing Else.&#xA;Follow this JSON structure:&#xA;json_structure:&#xA;{&#xA;invoiceNr: ,&#xA;firstName: ,&#xA;lastName:   ,&#xA;amount: ,&#xA;currency: ,&#xA;company: ,&#xA;address:&#xA;    {&#xA;        street: ,&#xA;        city: ,&#xA;        PLZ: &#xA;    },&#xA;createDate: ,&#xA;modifiedDate: ,&#xA;invoiceForwarded:&#xA;}&#xA;&quot;]" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.instruction" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="x:String" xml:space="preserve">["I will give you a German text from an invoice.
Please extract the relevant information and prepare a JSON.
For the first and lasst name use the name that you think is the invoice recipient.
Also for the address use the address of the recipient (in German this is sometimes called Rechnungsadresse).
If the invoice recipient is not a person, but a company, write its company name at firstName and write no last name
Preferably, for the InvoiceNr use the Rechnungsnummer, not the Bestellnummer.
For currencies, use the ISO currency code (like EUR or CHF).
For company, use the name of the company that is issuing the invoice.
For createDate and modifiedDate, use" + date_today + ".
For invoiceForwarded, write false.
Please only give me the JSON In the response, Nothing Else.
Follow this JSON structure:
json_structure:
{
invoiceNr: ,
firstName: ,
lastName:   ,
amount: ,
currency: ,
company: ,
address:
    {
        street: ,
        city: ,
        PLZ: 
    },
createDate: ,
modifiedDate: ,
invoiceForwarded:
}
"]</InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
                <uiisi:OperationEntityField.Value>
                  <VisualBasicValue x:TypeArguments="x:String" xml:space="preserve">["I will give you a German text from an invoice.
Please extract the relevant information and prepare a JSON.
For the first and lasst name use the name that you think is the invoice recipient.
Also for the address use the address of the recipient (in German this is sometimes called Rechnungsadresse).
If the invoice recipient is not a person, but a company, write its company name at firstName and write no last name
Preferably, for the InvoiceNr use the Rechnungsnummer, not the Bestellnummer.
For currencies, use the ISO currency code (like EUR or CHF).
For company, use the name of the company that is issuing the invoice.
For createDate and modifiedDate, use" + date_today + ".
For invoiceForwarded, write false.
Please only give me the JSON In the response, Nothing Else.
Follow this JSON structure:
json_structure:
{
invoiceNr: ,
firstName: ,
lastName:   ,
amount: ,
currency: ,
company: ,
address:
    {
        street: ,
        city: ,
        PLZ: 
    },
createDate: ,
modifiedDate: ,
invoiceForwarded:
}
"]</VisualBasicValue>
                </uiisi:OperationEntityField.Value>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="x:String" x:Name="__ReferenceID17" ArgumentDirection="In" ArgumentType="x:String" DataType="String" DefaultValue="gpt-4" Description="Das Large Language Model (LLM), das für die Chatvervollständigung verwendet werden soll. Die Standardeinstellung ist gpt-4." DisplayName="Modellname" FormDataType="ExpressionTextBox" InArgumentValue="gpt-4" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.model" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="x:String">gpt-4</InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.EnumValues>
                  <scg:List x:TypeArguments="x:String" Capacity="3">
                    <x:String>gpt-4-0613</x:String>
                    <x:String>gpt-3.5-turbo-1106</x:String>
                    <x:String>gpt-4-vision-preview</x:String>
                  </scg:List>
                </uiisi:OperationEntityField.EnumValues>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
                <uiisi:OperationEntityField.Value>
                  <Literal x:TypeArguments="x:String">gpt-4</Literal>
                </uiisi:OperationEntityField.Value>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="s:Nullable(x:Int32)" InArgumentValue="{x:Reference __ReferenceID1}" Value="{x:Reference __ReferenceID0}" x:Name="__ReferenceID18" ArgumentDirection="In" ArgumentType="s:Nullable(x:Int32)" DataType="Int32" DefaultValue="1920" Description="Die maximale Anzahl von Token, die für die Eingabeaufforderung und die generierte Antwort zulässig sind. Weniger Token sind weniger teuer. Der Standardwert ist 3840." DisplayName="Max. Token" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.max_tokens" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="s:Nullable(x:Int32)" x:Name="__ReferenceID1">
                    <Literal x:TypeArguments="s:Nullable(x:Int32)" x:Name="__ReferenceID0" Value="1920" />
                  </InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="s:Nullable(x:Int32)" InArgumentValue="{x:Reference __ReferenceID3}" Value="{x:Reference __ReferenceID2}" x:Name="__ReferenceID19" ArgumentDirection="In" ArgumentType="s:Nullable(x:Int32)" DataType="Int32" DefaultValue="1" Description="Eine Zahl von mindestens 1. Damit wird festgelegt, wie viele Auswahlmöglichkeiten für die Vervollständigung die KI zurückgibt. Der Standardwert ist 1." DisplayName="N" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.n" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="s:Nullable(x:Int32)" x:Name="__ReferenceID3">
                    <Literal x:TypeArguments="s:Nullable(x:Int32)" x:Name="__ReferenceID2" Value="1" />
                  </InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="s:Nullable(x:Double)" InArgumentValue="{x:Reference __ReferenceID5}" Value="{x:Reference __ReferenceID4}" x:Name="__ReferenceID20" ArgumentDirection="In" ArgumentType="s:Nullable(x:Double)" DataType="Double" DefaultValue="1" Description="⌘ ⌥ K&#xA;Eine Zahl zwischen 0 und 2. Höhere Werte wie 0,8 machen die Ausgabe zufälliger, während niedrigere Werte wie 0,2 sie gezielter und deterministischer machen. Der Standardwert ist 1." DisplayName="Temperatur" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.temperature" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="s:Nullable(x:Double)" x:Name="__ReferenceID5">
                    <Literal x:TypeArguments="s:Nullable(x:Double)" x:Name="__ReferenceID4" Value="0.4" />
                  </InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="s:Nullable(x:Double)" InArgumentValue="{x:Reference __ReferenceID7}" Value="{x:Reference __ReferenceID6}" x:Name="__ReferenceID21" ArgumentDirection="In" ArgumentType="s:Nullable(x:Double)" DataType="Double" DefaultValue="1" Description="Eine Zahl zwischen 0 und 1. Je niedriger die Zahl, desto weniger Token werden berücksichtigt. Der Standardwert ist 1." DisplayName="Erste P" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.top_p" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="s:Nullable(x:Double)" x:Name="__ReferenceID7">
                    <Literal x:TypeArguments="s:Nullable(x:Double)" x:Name="__ReferenceID6" Value="1" />
                  </InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="s:Nullable(x:Boolean)" InArgumentValue="{x:Reference __ReferenceID9}" Value="{x:Reference __ReferenceID8}" x:Name="__ReferenceID22" ArgumentDirection="In" ArgumentType="s:Nullable(x:Boolean)" DataType="Boolean" DefaultValue="false" Description="Ob teilweiser Fortschritt zurückgestreamt werden soll. Wenn diese Option festgelegt ist, werden die Token als reine Server-Ereignisse gesendet, sobald sie verfügbar sind, und der Stream wird durch die Meldung „data: [DONE]“ beendet. Der Standardwert ist „false“." DisplayName="Stream" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.stream" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="s:Nullable(x:Boolean)" x:Name="__ReferenceID9">
                    <Literal x:TypeArguments="s:Nullable(x:Boolean)" x:Name="__ReferenceID8" Value="False" />
                  </InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="x:String" x:Name="__ReferenceID23" ArgumentDirection="In" ArgumentType="x:String" DataType="String" Description="Bis zu 4 Sequences, bei denen die API aufhört, weitere Token zu generieren. Der zurückgegebene Text enthält die Stopp-Sequence nicht. Der Standardwert ist NULL." DisplayName="Beenden" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.stop" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="s:Nullable(x:Double)" InArgumentValue="{x:Reference __ReferenceID11}" Value="{x:Reference __ReferenceID10}" x:Name="__ReferenceID24" ArgumentDirection="In" ArgumentType="s:Nullable(x:Double)" DataType="Double" DefaultValue="0" Description="Zahl zwischen -2,0 und 2,0. Bei positiven Werten werden neue Token auf der Grundlage geahndet, ob sie bisher im Text vorkommen, und die Wahrscheinlichkeit wird erhöht, dass das Modell über neue Themen spricht. Standardwert ist 0." DisplayName="Ahndung für Vorkommen" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.presence_penalty" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="s:Nullable(x:Double)" x:Name="__ReferenceID11">
                    <Literal x:TypeArguments="s:Nullable(x:Double)" x:Name="__ReferenceID10" Value="0" />
                  </InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="s:Nullable(x:Double)" InArgumentValue="{x:Reference __ReferenceID13}" Value="{x:Reference __ReferenceID12}" x:Name="__ReferenceID25" ArgumentDirection="In" ArgumentType="s:Nullable(x:Double)" DataType="Double" DefaultValue="0" Description="Zahl zwischen -2,0 und 2,0. Bei positiven Werten werden neue Token auf der Grundlage ihrer bisherigen Häufigkeit im Text geahndet und die Wahrscheinlichkeit wird verringert, dass das Modell dieselbe Zeile wortwörtlich wiederholt. Der Standardwert ist 0." DisplayName="Ahndung für Häufigkeit" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.frequency_penalty" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.ArgumentValue>
                  <InArgument x:TypeArguments="s:Nullable(x:Double)" x:Name="__ReferenceID13">
                    <Literal x:TypeArguments="s:Nullable(x:Double)" x:Name="__ReferenceID12" Value="0" />
                  </InArgument>
                </uiisi:OperationEntityField.ArgumentValue>
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="x:String" x:Name="__ReferenceID26" ArgumentDirection="In" ArgumentType="x:String" DataType="String" Description="Eine eindeutige Kennung für Ihren Endbenutzer, die OpenAI helfen kann, Missbrauch zu überwachen und zu erkennen. Der Standardwert ist null." DisplayName="Benutzer" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="body.user" Order="3" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
              <uiisi:OperationEntityField x:TypeArguments="x:String" x:Name="__ReferenceID27" ArgumentDirection="Out" ArgumentType="x:String" DataType="String" Description="Der von der KI generierte Text für die erste Auswahl" DisplayName="Am häufigsten generierter Text" FormDataType="ExpressionTextBox" IsChildEntityField="True" IsCustomField="False" IsDefault="False" IsDeletable="False" IsHidden="False" IsIdField="False" IsMandatory="False" IsPriority="False" IsSelected="False" Location="Undefined" Name="Response.text" ShouldFilterOnChange="False">
                <uiisi:OperationEntityField.Metadata>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <uiisi:CustomFieldsPriority x:Key="CustomFieldsPriority">Default</uiisi:CustomFieldsPriority>
                  </scg:Dictionary>
                </uiisi:OperationEntityField.Metadata>
              </uiisi:OperationEntityField>
            </scg:List>
          </uibi:BusinessEntity.AllFields>
          <uibi:BusinessEntity.EntityMetadata>
            <uibi:EntityMetadata DisplayName="Chatvervollständigung generieren" EligibleOperations="1" IsCustomEntity="False" Name="generateChatCompletion">
              <uibi:EntityMetadata.Metadata>
                <scg:Dictionary x:TypeArguments="x:String, x:Object" x:Name="__ReferenceID14">
                  <x:String x:Key="Object">generateChatCompletion</x:String>
                  <x:String x:Key="Client">UiPath.OpenAI.IntegrationService.Client.GenerateChatCompletionAPIClient</x:String>
                  <x:String x:Key="Operation">CreateGenerateChatCompletion</x:String>
                  <x:String x:Key="Path">/generateChatCompletion</x:String>
                </scg:Dictionary>
              </uibi:EntityMetadata.Metadata>
            </uibi:EntityMetadata>
          </uibi:BusinessEntity.EntityMetadata>
          <uibi:BusinessEntity.SelectedFields>
            <scg:List x:TypeArguments="uibi:EntityField" Capacity="16">
              <x:Reference>__ReferenceID15</x:Reference>
              <x:Reference>__ReferenceID16</x:Reference>
              <x:Reference>__ReferenceID17</x:Reference>
              <x:Reference>__ReferenceID18</x:Reference>
              <x:Reference>__ReferenceID19</x:Reference>
              <x:Reference>__ReferenceID20</x:Reference>
              <x:Reference>__ReferenceID21</x:Reference>
              <x:Reference>__ReferenceID22</x:Reference>
              <x:Reference>__ReferenceID23</x:Reference>
              <x:Reference>__ReferenceID24</x:Reference>
              <x:Reference>__ReferenceID25</x:Reference>
              <x:Reference>__ReferenceID26</x:Reference>
              <x:Reference>__ReferenceID27</x:Reference>
              <x:Reference>__ReferenceID28</x:Reference>
            </scg:List>
          </uibi:BusinessEntity.SelectedFields>
          <uibi:BusinessEntity.TelemetryProperties>
            <scg:Dictionary x:TypeArguments="uibi:TelemetryGroup, scg:IDictionary(x:String, x:String)" />
          </uibi:BusinessEntity.TelemetryProperties>
        </uibi:BusinessEntity>
      </uoia:GenerateChatCompletion.BusinessEntity>
      <uoia:GenerateChatCompletion.CachedLookupValues>
        <scg:Dictionary x:TypeArguments="x:String, scg:List(uiisi:LookupValue)" />
      </uoia:GenerateChatCompletion.CachedLookupValues>
      <uoia:GenerateChatCompletion.DesignConnectionRequest>
        <uiisi:ConnectionParameters AuthType="ElementInstance" ConnectionId="8a004e94-db95-449c-a9f8-a9953dc626b7" ConnectionName="OpenAI - user-olbrln9foaxgsaacxazwvzms" ConnectorKey="uipath-openai-openai">
          <uiisi:ConnectionParameters.TelemetryInfo>
            <uiisi:TelemetryInfo ActivityPack="UiPath.OpenAI.IntegrationService.Activities" ActivityPackVersion="6.1.0" Source="StudioDesktop" />
          </uiisi:ConnectionParameters.TelemetryInfo>
        </uiisi:ConnectionParameters>
      </uoia:GenerateChatCompletion.DesignConnectionRequest>
      <uoia:GenerateChatCompletion.SelectedFields>
        <scg:List x:TypeArguments="uibi:EntityField" Capacity="14">
          <x:Reference>__ReferenceID15</x:Reference>
          <x:Reference>__ReferenceID16</x:Reference>
          <x:Reference>__ReferenceID17</x:Reference>
          <x:Reference>__ReferenceID18</x:Reference>
          <x:Reference>__ReferenceID19</x:Reference>
          <x:Reference>__ReferenceID20</x:Reference>
          <x:Reference>__ReferenceID21</x:Reference>
          <x:Reference>__ReferenceID22</x:Reference>
          <x:Reference>__ReferenceID23</x:Reference>
          <x:Reference>__ReferenceID24</x:Reference>
          <x:Reference>__ReferenceID25</x:Reference>
          <x:Reference>__ReferenceID26</x:Reference>
          <x:Reference>__ReferenceID27</x:Reference>
          <x:Reference>__ReferenceID28</x:Reference>
        </scg:List>
      </uoia:GenerateChatCompletion.SelectedFields>
      <uoia:GenerateChatCompletion.TelemetryProperties>
        <scg:Dictionary x:TypeArguments="uibi:TelemetryGroup, scg:IDictionary(x:String, x:String)" />
      </uoia:GenerateChatCompletion.TelemetryProperties>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </uoia:GenerateChatCompletion>
    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,144.66666666666666" sap2010:WorkflowViewState.IdRef="LogMessage_5" Level="Info" Message="[&quot;Extracted data from text via GPT.&quot;]" />
    <ui:MessageBox Caption="{x:Null}" ChosenButton="{x:Null}" AutoCloseAfter="00:00:00" DisplayName="Message Box" sap:VirtualizedContainerService.HintSize="434,86.66666666666667" sap2010:WorkflowViewState.IdRef="MessageBox_2" Text="[&quot;GPT Output:&#xA;--------------&#xA;&quot;+response.text]" />
    <Assign sap2010:Annotation.AnnotationText="Assign out_argument: JSON output from GPT." sap:VirtualizedContainerService.HintSize="434,116" sap2010:WorkflowViewState.IdRef="Assign_4">
      <Assign.To>
        <OutArgument x:TypeArguments="x:String">[out_response_text]</OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="x:String">[response.Text]</InArgument>
      </Assign.Value>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </Assign>
  </Sequence>
</Activity>